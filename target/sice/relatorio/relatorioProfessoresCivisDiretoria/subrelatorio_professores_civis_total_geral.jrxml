<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="subrelatorio_professores_civis" language="groovy" pageWidth="403" pageHeight="15" columnWidth="403" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="id_om" class="java.lang.Integer"/>
	<parameter name="id_periodo" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[SELECT SUPERIOR_ID,

        TIPO,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL


FROM (

/*  Pega as Tres Oms subordinadas a DETMIL */

  SELECT  'EBTT' AS TIPO,
        'DETMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (


SELECT DISTINCT SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_GRADUACAO ,


    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 4
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (26)

  AND PC.CARREIRA = 'EBTT'


UNION

  SELECT 4 AS SUPERIOR_ID,
        'CEADEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL

  SELECT  'EBTT' AS TIPO,
        'DETMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (


SELECT DISTINCT SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 4
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (23)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 4 AS SUPERIOR_ID,
        'CEP/FDC' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL



  SELECT  'EBTT' AS TIPO,
        'DETMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (


SELECT DISTINCT  SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 4
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (24)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 4 AS SUPERIOR_ID,
        'CIdEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


/*  Pega os trezes  colegios Militares  subordinadas a DEPA */


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL



FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (27)

  AND PC.CARREIRA = 'EBTT'

UNION

  SELECT 3 AS SUPERIOR_ID,
        'CMB' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (37)

  AND PC.CARREIRA = 'EBTT'


  UNION

  SELECT 3 AS SUPERIOR_ID,
        'CMBel' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL




  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL



  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)


    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (34)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 3 AS SUPERIOR_ID,
        'CMC' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL



  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL



FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (33)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 3 AS SUPERIOR_ID,
        'CMCG' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (30)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 3 AS SUPERIOR_ID,
        'CMF' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (32)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 3 AS SUPERIOR_ID,
        'CMJF' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL



FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (29)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 3 AS SUPERIOR_ID,
        'CMM' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
      OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (35)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 3 AS SUPERIOR_ID,
        'CMPA' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (31)

  AND PC.CARREIRA = 'EBTT'

UNION

SELECT 3 AS SUPERIOR_ID,
        'CMR' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (28)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 3 AS SUPERIOR_ID,
        'CMRJ' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (36)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 3 AS SUPERIOR_ID,
        'CMSM' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL

  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (17)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 3 AS SUPERIOR_ID,
        'CPOR-BH/CMBH' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL



  SELECT  'EBTT' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
    CASE
	   WHEN om.sigla='CPOR-BH/CMBH' THEN 'CMBH'
	   WHEN om.sigla='EsFCEx/CMS' THEN 'CMS'
	   ELSE om.sigla END as SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (12)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 3 AS SUPERIOR_ID,
        'CMS' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL

/*  Pega as Tres Oms subordinadas a DESMIL */


SELECT  'EBTT' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        'CPOR-BH' AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  0 AS TOTAL_DOUTOR ,

    0 AS TOTAL_MESTRE ,

    0 AS TOTAL_POSGRADUACAO ,

    0 AS TOTAL_GRADUACAO ,

    0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

   0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    0 AS TOTAL_20H,

   0 AS TOTAL_MASCULINO,

     0 AS TOTAL_FEMININO,

   0 AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (17)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 2 AS SUPERIOR_ID,
        'CPOR-BH' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL



SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        'CPOR/BH' AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (17)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

  SELECT 2 AS SUPERIOR_ID,
        'CPOR/BH' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL



SELECT  'EBTT' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (9)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 2 AS SUPERIOR_ID,
        'AMAN' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (7)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 2 AS SUPERIOR_ID,
        'ECEME' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL

  SELECT  'EBTT' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (


SELECT DISTINCT  SS.SUPERIOR_ID,
SIGLA,
  0 AS TOTAL_DOUTOR ,

    0 AS TOTAL_MESTRE ,

    0 AS TOTAL_POSGRADUACAO ,

    0 AS TOTAL_GRADUACAO ,

    0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    0 AS TOTAL_20H,

    0 AS TOTAL_MASCULINO,

    0 AS TOTAL_FEMININO,

   0 AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (12)

  AND PC.CARREIRA = 'EBTT'

  UNION

     SELECT 2 AS SUPERIOR_ID,
        'EsFCEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION



  SELECT  'EBTT' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (10)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 2 AS SUPERIOR_ID,
        'EsPCEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

/*  Pega as Tres Oms subordinadas a CCFEx */

UNION ALL


  SELECT  'EBTT' AS TIPO,
        'CCFEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 6
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (44)

  AND PC.CARREIRA = 'EBTT'

  UNION

  SELECT 6 AS SUPERIOR_ID,
        'EsEFEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL

  SELECT  'EBTT' AS TIPO,
        'CCFEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 6
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (46)

  AND PC.CARREIRA = 'EBTT'

UNION

  SELECT 6 AS SUPERIOR_ID,
        'IPCFEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

/*  Pega as Tres Oms subordinadas a DPHCEx */


UNION ALL


  SELECT  'EBTT' AS TIPO,
        'DPHCEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 5
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (42)

  AND PC.CARREIRA = 'EBTT'

 UNION
   SELECT 5 AS SUPERIOR_ID,
        'BIBLIEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

union all

  SELECT  'EBTT' AS TIPO,
        'DPHCEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 5
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (40)

  AND PC.CARREIRA = 'EBTT'

UNION

   SELECT 5 AS SUPERIOR_ID,
        '"MHEx/FC"' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


/* Inicio  MAGISTERIOSUPERIOR */


UNION ALL

/*  Pega as Tres Oms subordinadas a DETMIL */



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DETMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (26)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 4
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (26)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

    SELECT 4 AS SUPERIOR_ID,
        'CEADEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DETMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (23)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 4
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (23)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

      SELECT 4 AS SUPERIOR_ID,
        'CEP/FDC' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DETMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (24)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 4
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (24)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

UNION

    SELECT 4 AS SUPERIOR_ID,
        'CIdEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL

/*  Pega os trezes  colegios Militares  subordinadas a DEPA */

  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (27)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (27)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

UNION

    SELECT 3 AS SUPERIOR_ID,
        'CMB' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T


GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
      OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (37)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (37)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

      SELECT 3 AS SUPERIOR_ID,
        'CMBel' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)


    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (34)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (34)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

 UNION

    SELECT 3 AS SUPERIOR_ID,
        'CMC' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL



  ) AS T


GROUP BY SIGLA,SUPERIOR_ID


UNION ALL



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (33)

    ),0) AS TOTAL



FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (33)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMCG' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
      OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (30)

    ),0) AS TOTAL



FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (30)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMF' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (32)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (32)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMJF' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
      OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (29)

    ),0) AS TOTAL



FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (29)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMM' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (35)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (35)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMPA' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (31)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (31)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMR' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL

  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (28)

    ),0) AS TOTAL



FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (28)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMRJ' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL



  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (36)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (36)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMSM' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (17)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (17)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CPOR-BH/CMBH' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DEPA' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     CASE
	   WHEN om.sigla='CPOR-BH/CMBH' THEN 'CMBH'
	   WHEN om.sigla='EsFCEx/CMS' THEN 'EsFCEx'
	   ELSE om.sigla END as SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 3
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (12)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 3 AS SUPERIOR_ID,
        'CMS' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL

/*  Pega as Tres Oms subordinadas a DESMIL */

  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
      OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (9)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (9)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 2 AS SUPERIOR_ID,
        'AMAN' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
   OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (7)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (7)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 2 AS SUPERIOR_ID,
        'ECEME' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
    OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (12)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (12)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 2 AS SUPERIOR_ID,
        'EsFCEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID


UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DESMIL' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT   SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (10)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 2
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (10)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 2 AS SUPERIOR_ID,
        'EsPCEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID



/*  Pega as Tres Oms subordinadas a CCFEx */


UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'CCFEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (



SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (44)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 6
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (44)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 6 AS SUPERIOR_ID,
        'EsEFEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'CCFEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (46)

    ),0) AS TOTAL

FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 6
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (46)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

  UNION

     SELECT 6 AS SUPERIOR_ID,
        'IPCFEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID



/*  Pega as Tres Oms subordinadas a DPHCEx */


UNION ALL


  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DPHCEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (42)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 5
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (42)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

 UNION

    SELECT 5 AS SUPERIOR_ID,
        'BIBLIEx' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL


  ) AS T

GROUP BY SIGLA,SUPERIOR_ID

union all

  SELECT  'MAGISTERIOSUPERIOR' AS TIPO,
        'DPHCEx' AS DIRETORIA,
        SUPERIOR_ID AS SUPERIOR_ID,
        SIGLA AS SIGLA,
        COALESCE(SUM(TOTAL_DOUTOR),0) AS TOTAL_DOUTOR,
        COALESCE(SUM(TOTAL_MESTRE),0) AS TOTAL_MESTRE ,
        COALESCE(SUM(TOTAL_POSGRADUACAO),0) AS TOTAL_POSGRADUACAO,
        COALESCE(SUM(TOTAL_GRADUACAO),0) AS TOTAL_GRADUACAO,
        COALESCE(SUM(TOTAL_40HCOMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_40HSEMDEDICACAOEXCLUSIVA),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        COALESCE(SUM(TOTAL_20H),0) AS TOTAL_20H,
        COALESCE(SUM(TOTAL_MASCULINO),0) AS TOTAL_MASCULINO,
        COALESCE(SUM(TOTAL_FEMININO),0)  AS TOTAL_FEMININO,
        COALESCE(SUM(TOTAL),0)  AS TOTAL

FROM (

SELECT DISTINCT  SS.SUPERIOR_ID,
     OM.SIGLA AS SIGLA,
  COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_DOUTOR
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'DOUTOR'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_DOUTOR ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_MESTRE
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'MESTRE'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_MESTRE ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_POSGRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'POSGRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_POSGRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_GRADUACAO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.ESCOLARIDADE = 'GRADUACAO'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_GRADUACAO ,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHCOMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_QUARENTAHCOMDEDICACAOEXCLUSIVA
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'QUARENTAHSEMDEDICACAOEXCLUSIVA'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,

    COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL_20H
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.REGIMEDETRABALHO = 'VINTEH'
      AND PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_20H,

    COALESCE((SELECT SUM(PC1.MASCULINO) AS TOTAL_MASCULINO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_MASCULINO,

     COALESCE((SELECT SUM(PC1.FEMININO) AS TOTAL_FEMININO
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL_FEMININO,

   COALESCE((SELECT SUM(PC1.FEMININO + PC1.MASCULINO) AS TOTAL
    FROM PROFESSORCIVIL PC1
    INNER JOIN SUPERIORES_SUBORDINADOS SS2
      ON SS2.SUPERIOR_SUBORDINADO_ID = PC1.ORGANIZACAO_ID
    WHERE PC1.CARREIRA = PC.CARREIRA
      AND PC1.PERIODO_ID = PC.PERIODO_ID
      AND SS2.SUPERIOR_ID = SS.SUPERIOR_ID
      AND SS2.SUPERIOR_SUBORDINADO_ID IN (40)

    ),0) AS TOTAL


FROM PROFESSORCIVIL PC
INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = PC.ORGANIZACAO_ID
INNER JOIN ORGANIZACAOMILITAR OM ON OM.ID = SS.SUPERIOR_SUBORDINADO_ID

  WHERE SS.SUPERIOR_ID = 5
  AND PC.PERIODO_ID = $P{id_periodo}
  AND SS.SUPERIOR_SUBORDINADO_ID IN (40)

  AND PC.CARREIRA = 'MAGISTERIOSUPERIOR'

UNION

   SELECT 5 AS SUPERIOR_ID,
        '"MHEx/FC"' AS SIGLA,
        0 AS TOTAL_DOUTOR,
        0 AS TOTAL_MESTRE ,
        0 AS TOTAL_POSGRADUACAO,
        0 AS TOTAL_GRADUACAO,
        0 AS TOTAL_40HCOMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_40HSEMDEDICACAOEXCLUSIVA,
        0 AS TOTAL_20H,
        0 AS TOTAL_MASCULINO,
        0  AS TOTAL_FEMININO,
        0  AS TOTAL

  ) AS T

GROUP BY SIGLA,SUPERIOR_ID



) TABELAO

WHERE TABELAO.SUPERIOR_ID = $P{id_om}


  GROUP BY TIPO,     SUPERIOR_ID
ORDER BY 2 ASC
]]>
	</queryString>
	<field name="superior_id" class="java.lang.Long"/>
	<field name="tipo" class="java.lang.String"/>
	<field name="total_doutor" class="java.lang.Integer"/>
	<field name="total_mestre" class="java.lang.Integer"/>
	<field name="total_posgraduacao" class="java.lang.Integer"/>
	<field name="total_graduacao" class="java.lang.Integer"/>
	<field name="total_40hcomdedicacaoexclusiva" class="java.lang.Integer"/>
	<field name="total_40hsemdedicacaoexclusiva" class="java.lang.Integer"/>
	<field name="total_20h" class="java.lang.Integer"/>
	<field name="total_masculino" class="java.lang.Integer"/>
	<field name="total_feminino" class="java.lang.Integer"/>
	<field name="total" class="java.lang.Integer"/>
	<variable name="total_doutor_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_doutor}]]></variableExpression>
	</variable>
	<variable name="total_mestre_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_mestre}]]></variableExpression>
	</variable>
	<variable name="total_posgraduacao_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_posgraduacao}]]></variableExpression>
	</variable>
	<variable name="total_graduacao_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_graduacao}]]></variableExpression>
	</variable>
	<variable name="total_40hcomdedicacaoexclusiva_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_40hcomdedicacaoexclusiva}]]></variableExpression>
	</variable>
	<variable name="total_40hsemdedicacaoexclusiva_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_40hsemdedicacaoexclusiva}]]></variableExpression>
	</variable>
	<variable name="total_20h_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_20h}]]></variableExpression>
	</variable>
	<variable name="total_masculino_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_masculino}]]></variableExpression>
	</variable>
	<variable name="total_feminino_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_feminino}]]></variableExpression>
	</variable>
	<variable name="total_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total}]]></variableExpression>
	</variable>
	<variable name="total_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total}]]></variableExpression>
	</variable>
	<detail>
		<band height="15">
			<textField pattern="">
				<reportElement mode="Opaque" x="0" y="0" width="110" height="15" backcolor="#99CCFF"/>
				<box leftPadding="5">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{tipo}== "EBTT" ? "EBTT":
$F{tipo}=="MAGISTERIOSUPERIOR" ? "MAGISTÉRIO SUPERIOR" : ""]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="110" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_doutor}==0?'-':$F{total_doutor}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="137" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_mestre}==0?'-':$F{total_mestre}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="164" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_posgraduacao}==0?'-':$F{total_posgraduacao}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="191" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_graduacao}==0?'-':$F{total_graduacao}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="218" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_40hcomdedicacaoexclusiva}==0?'-':$F{total_40hcomdedicacaoexclusiva}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="245" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_40hsemdedicacaoexclusiva}==0?'-':$F{total_40hsemdedicacaoexclusiva}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="272" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_20h}==0?'-':$F{total_20h}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="299" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_masculino}==0?'-':$F{total_masculino}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="326" y="0" width="27" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_feminino}==0?'-':$F{total_feminino}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="353" y="0" width="50" height="15" backcolor="#99CCFF"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total}==0?'-':$F{total}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
