SELECT SIGLA,
        SUM(PROFESSOR_COMISSAO_MASCULINO) AS PROFESSOR_COMISSAO_MASCULINO,
        SUM(PROFESSOR_COMISSAO_FEMININO)  AS PROFESSOR_COMISSAO_FEMININO,
        SUM(PROFESSOR_PERMANENTE_MASCULINO)  AS PROFESSOR_PERMANENTE_MASCULINO,
        SUM(PROFESSOR_PERMANENTE_FEMININO)  AS PROFESSOR_PERMANENTE_FEMININO,
	SUM(PROFESSOR_QFE_MASCULINO) AS PROFESSOR_QFE_MASCULINO,
        SUM(PROFESSOR_QFE_FEMININO) AS PROFESSOR_QFE_FEMININO,
        SUM(PROFESSOR_DSA_MASCULINO) AS PROFESSOR_DSA_MASCULINO,
        SUM(PROFESSOR_DSA_FEMININO) AS PROFESSOR_DSA_FEMININO,
        SUM(PROFESSOR_QCO_MASCULINO)  AS PROFESSOR_QCO_MASCULINO,
        SUM(PROFESSOR_QCO_FEMININO) AS PROFESSOR_QCO_FEMININO,
        SUM(PROFESSOR_TEMPORARIO_MASCULINO)  AS PROFESSOR_TEMPORARIO_MASCULINO,
        SUM(PROFESSOR_TEMPORARIO_FEMININO)  AS PROFESSOR_TEMPORARIO_FEMININO,
        SUM(PROFESSOR_PTTC_MASCULINO) AS PROFESSOR_PTTC_MASCULINO,
        SUM(PROFESSOR_PTTC_FEMININO) AS PROFESSOR_PTTC_FEMININO,
	SUM(
		PROFESSOR_COMISSAO_MASCULINO + PROFESSOR_COMISSAO_FEMININO + PROFESSOR_PERMANENTE_MASCULINO + 
		PROFESSOR_PERMANENTE_FEMININO + PROFESSOR_QFE_MASCULINO + PROFESSOR_QFE_FEMININO + PROFESSOR_DSA_MASCULINO + 
		PROFESSOR_DSA_FEMININO + PROFESSOR_QCO_MASCULINO + PROFESSOR_QCO_FEMININO + PROFESSOR_TEMPORARIO_MASCULINO + 
		PROFESSOR_TEMPORARIO_FEMININO + PROFESSOR_PTTC_MASCULINO + PROFESSOR_PTTC_FEMININO
	) AS TOTAL

FROM (
 SELECT SIGLA,
        COALESCE(SUM(PROFESSOR_COMISSAO_MASCULINO) , 0)  AS PROFESSOR_COMISSAO_MASCULINO,
        COALESCE(SUM(PROFESSOR_COMISSAO_FEMININO) , 0)  AS PROFESSOR_COMISSAO_FEMININO,
        COALESCE(SUM(PROFESSOR_PERMANENTE_MASCULINO) , 0)  AS PROFESSOR_PERMANENTE_MASCULINO,
        COALESCE(SUM(PROFESSOR_PERMANENTE_FEMININO) , 0)  AS PROFESSOR_PERMANENTE_FEMININO,
        COALESCE(SUM(PROFESSOR_QFE_MASCULINO) , 0)  AS PROFESSOR_QFE_MASCULINO,
        COALESCE(SUM(PROFESSOR_QFE_FEMININO) , 0)  AS PROFESSOR_QFE_FEMININO,
	COALESCE(SUM(PROFESSOR_DSA_MASCULINO) , 0)  AS PROFESSOR_DSA_MASCULINO,
        COALESCE(SUM(PROFESSOR_DSA_FEMININO) , 0)  AS PROFESSOR_DSA_FEMININO,
        COALESCE(SUM(PROFESSOR_QCO_MASCULINO) , 0)  AS PROFESSOR_QCO_MASCULINO,
        COALESCE(SUM(PROFESSOR_QCO_FEMININO) , 0)  AS PROFESSOR_QCO_FEMININO,
        COALESCE(SUM(PROFESSOR_TEMPORARIO_MASCULINO) , 0)  AS PROFESSOR_TEMPORARIO_MASCULINO,
        COALESCE(SUM(PROFESSOR_TEMPORARIO_FEMININO) , 0)  AS PROFESSOR_TEMPORARIO_FEMININO,
        COALESCE(SUM(PROFESSOR_PTTC_MASCULINO) , 0)  AS PROFESSOR_PTTC_MASCULINO,
        COALESCE(SUM(PROFESSOR_PTTC_FEMININO) , 0)  AS PROFESSOR_PTTC_FEMININO,
        COALESCE(SUM(
		PROFESSOR_COMISSAO_MASCULINO + PROFESSOR_COMISSAO_FEMININO + PROFESSOR_PERMANENTE_MASCULINO + 
		PROFESSOR_PERMANENTE_FEMININO + PROFESSOR_QFE_MASCULINO + PROFESSOR_QFE_FEMININO + PROFESSOR_DSA_MASCULINO + 
		PROFESSOR_DSA_FEMININO + PROFESSOR_QCO_MASCULINO + PROFESSOR_QCO_FEMININO + PROFESSOR_TEMPORARIO_MASCULINO + 
		PROFESSOR_TEMPORARIO_FEMININO + PROFESSOR_PTTC_MASCULINO + PROFESSOR_PTTC_FEMININO
	) , 0) AS TOTAL

FROM (

 SELECT DISTINCT OM.SIGLA,
       COALESCE(( SELECT SUM(PM2.MASCULINO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'PROFESSOR_EM_COMISSAO'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_COMISSAO_MASCULINO,
        
         COALESCE(( SELECT SUM(PM2.FEMININO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'PROFESSOR_EM_COMISSAO'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_COMISSAO_FEMININO,
		
       COALESCE(( SELECT SUM(PM2.MASCULINO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'PROFESSOR_PERMANENTE'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_PERMANENTE_MASCULINO,
        
       COALESCE(( SELECT SUM(PM2.FEMININO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'PROFESSOR_PERMANENTE'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_PERMANENTE_FEMININO,
		
       COALESCE(( SELECT SUM(PM2.MASCULINO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'QFE'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_QFE_MASCULINO,
        
       COALESCE(( SELECT SUM(PM2.FEMININO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'QFE'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_QFE_FEMININO,
        
       COALESCE(( SELECT SUM(PM2.MASCULINO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'DSA'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_DSA_MASCULINO,
        
       COALESCE(( SELECT SUM(PM2.FEMININO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'DSA'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_DSA_FEMININO,
     
       COALESCE(( SELECT SUM(PM2.MASCULINO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'QCO'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_QCO_MASCULINO,
        
       COALESCE(( SELECT SUM(PM2.FEMININO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'QCO'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_QCO_FEMININO,
     
       COALESCE(( SELECT SUM(PM2.MASCULINO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'TEMPORARIO'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_TEMPORARIO_MASCULINO,
        
       COALESCE(( SELECT SUM(PM2.FEMININO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'TEMPORARIO'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_TEMPORARIO_FEMININO,
     
       COALESCE(( SELECT SUM(PM2.MASCULINO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'PTTC'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_PTTC_MASCULINO,
        
       COALESCE(( SELECT SUM(PM2.FEMININO) 
          FROM PROFESSORMILITAR PM2
           WHERE PM2.TIPOPROFESSORMILITAR = 'PTTC'  
           AND PM2.ORGANIZACAO_ID = OMSUB.ID
           AND PM2.PERIODO_ID = PM.PERIODO_ID
             
        )) AS PROFESSOR_PTTC_FEMININO 

        FROM PROFESSORMILITAR PM                                       
        INNER JOIN  ORGANIZACAOMILITAR OM ON OM.ID = PM.ORGANIZACAO_ID
        INNER JOIN SUPERIORES_SUBORDINADOS SS ON SS.SUPERIOR_SUBORDINADO_ID = OM.ID
        INNER JOIN  ORGANIZACAOMILITAR OMSUB ON OMSUB.ID = SS.SUPERIOR_SUBORDINADO_ID
      
                    
        WHERE SS.SUPERIOR_ID = 4
        AND  PM.PERIODO_ID = 16
) T
GROUP BY SIGLA

UNION 

  SELECT OMSUB.SIGLA,
          0  AS PROFESSOR_COMISSAO_MASCULINO,
          0  AS PROFESSOR_COMISSAO_FEMININO,
          0  AS PROFESSOR_PERMANENTE_MASCULINO,
          0  AS PROFESSOR_PERMANENTE_FEMININO,
	  0  AS PROFESSOR_QFE_MASCULINO,
	  0  AS PROFESSOR_QFE_FEMININO,
          0  AS PROFESSOR_DSA_MASCULINO,
          0  AS PROFESSOR_DSA_FEMININO,
          0  AS PROFESSOR_QCO_MASCULINO,
          0  AS PROFESSOR_QCO_FEMININO,
          0  AS PROFESSOR_TEMPORARIO_MASCULINO,
          0  AS PROFESSOR_TEMPORARIO_FEMININO,
          0  AS PROFESSOR_PTTC_MASCULINO,
          0  AS PROFESSOR_PTTC_FEMININO,
	  0  AS TOTAL
  
  FROM SUPERIORES_SUBORDINADOS SS 
    LEFT  JOIN  ORGANIZACAOMILITAR OM ON SS.SUPERIOR_SUBORDINADO_ID = OM.ID
    LEFT  JOIN  ORGANIZACAOMILITAR OMSUB ON OMSUB.ID = SS.SUPERIOR_SUBORDINADO_ID
   WHERE SS.SUPERIOR_ID = 4

) TABELA 

   GROUP BY SIGLA